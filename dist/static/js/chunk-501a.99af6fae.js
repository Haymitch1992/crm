(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-501a"],{"4p7F":function(e,t,a){},"77fj":function(e,t,a){"use strict";var s=a("Btlj");a.n(s).a},Btlj:function(e,t,a){},RQYR:function(e,t,a){"use strict";var s=a("vW4c");a.n(s).a},ZX9L:function(e,t,a){"use strict";var s={name:"TimeTypeSelect",props:{defaultType:[String,Object],width:{type:Number,default:200},options:{type:Array,default:function(){return[{label:"今天",value:"today"},{label:"昨天",value:"yesterday"},{label:"本周",value:"week"},{label:"上周",value:"lastWeek"},{label:"本月",value:"month"},{label:"上月",value:"lastMonth"},{label:"本季度",value:"quarter"},{label:"上季度",value:"lastQuarter"},{label:"本年",value:"year"},{label:"去年",value:"lastYear"}]}}},data:function(){return{selectType:{label:"本年",value:"year"},showTypePopover:!1,showCustomContent:!1,sureCustomContent:!1,startTime:"",endTime:""}},computed:{typeShowValue:function(){return this.sureCustomContent?this.startTime||this.endTime?(this.startTime||"")+"-"+(this.endTime||""):"":this.selectType.label}},watch:{defaultType:function(){this.selectType.value!=this.defaultType&&(this.selectType=this.getDefaultTypeValue(this.defaultType))}},mounted:function(){void 0!==this.defaultType?"string"==typeof this.defaultType?this.selectType=this.getDefaultTypeValue(this.defaultType):this.defaultType.label?this.selectType=this.defaultType:"default"==this.defaultType.type?this.selectType=this.getDefaultTypeValue(this.defaultType.value):"custom"==this.defaultType.type&&(this.sureCustomContent=!0,this.showCustomContent=!0,this.startTime=this.defaultType.startTime,this.endTime=this.defaultType.endTime):this.$emit("change",{type:"default",value:this.selectType.value})},methods:{getDefaultTypeValue:function(e){for(var t=0;t<this.options.length;t++){var a=this.options[t];if(a.value==e)return a}return{label:"本年",value:"year"}},typeSelectClick:function(e){this.showTypePopover=!1,this.sureCustomContent=!1,this.showCustomContent=!1,this.selectType=e,this.$emit("change",{type:"default",value:this.selectType.value})},customSureClick:function(){this.startTime&&this.endTime&&(this.sureCustomContent=!0,this.showTypePopover=!1,this.$emit("change",{type:"custom",startTime:this.startTime,endTime:this.endTime}))}}},i=(a("77fj"),a("KHd+")),n=Object(i.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-popover",{staticClass:"time-type-select",attrs:{width:e.width,placement:"bottom","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showTypePopover,callback:function(t){e.showTypePopover=t},expression:"showTypePopover"}},[a("div",{staticClass:"type-popper"},[a("div",{staticClass:"type-content"},[e._l(e.options,function(t,s){return a("div",{key:s,staticClass:"type-content-item",class:{selected:e.selectType.value==t.value&&!e.showCustomContent},on:{click:function(a){e.typeSelectClick(t)}}},[a("div",{staticClass:"mark"}),e._v(e._s(t.label)+"\n      ")])}),e._v(" "),a("div",{staticClass:"type-content-item",class:{selected:e.showCustomContent},on:{click:function(t){e.showCustomContent=!0}}},[a("div",{staticClass:"mark"}),e._v("自定义\n      ")])],2),e._v(" "),e.showCustomContent?a("div",{staticClass:"type-content-custom"},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy.MM.dd",placeholder:"选择日期"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}}),e._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy.MM.dd",placeholder:"选择日期"},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}}),e._v(" "),a("el-button",{on:{click:e.customSureClick}},[e._v("确定")])],1):e._e()]),e._v(" "),a("el-input",{staticClass:"type-select",style:{width:e.width+"px"},attrs:{slot:"reference",readonly:!0},slot:"reference",model:{value:e.typeShowValue,callback:function(t){e.typeShowValue=t},expression:"typeShowValue"}},[a("i",{class:["el-icon-arrow-up",{"is-reverse":e.showTypePopover}],attrs:{slot:"suffix"},slot:"suffix"})])],1)},[],!1,null,"20503202",null);n.options.__file="index.vue";t.a=n.exports},"a/y2":function(e,t,a){},"ej9+":function(e,t,a){"use strict";var s={name:"BaseTabsHead",components:{},props:{selectValue:[String,Number],tabs:Array},data:function(){return{currentValue:""}},computed:{},watch:{selectValue:function(){this.currentValue=this.selectValue}},mounted:function(){this.currentValue=this.selectValue},beforeDestroy:function(){},methods:{handleTabsClick:function(e,t){this.$emit("update:selectValue",e.name),this.$emit("change",e.name)}}},i=(a("kr3W"),a("KHd+")),n=Object(i.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("flexbox",{staticClass:"base-tabs-head",attrs:{justify:"space-between"}},[a("div",[e._t("left")],2),e._v(" "),a("el-tabs",{on:{"tab-click":e.handleTabsClick},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}},e._l(e.tabs,function(e,t){return a("el-tab-pane",{key:t+e.name,attrs:{label:e.label,name:e.name}})})),e._v(" "),a("div",[e._t("right")],2)],1)},[],!1,null,"fa74c14a",null);n.options.__file="index.vue";t.a=n.exports},kr3W:function(e,t,a){"use strict";var s=a("4p7F");a.n(s).a},m1cH:function(e,t,a){"use strict";t.__esModule=!0;var s,i=a("rfXi"),n=(s=i)&&s.__esModule?s:{default:s};t.default=function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return(0,n.default)(e)}},"u+/2":function(e,t,a){"use strict";a.r(t);var s=a("4XAY"),i=a("ej9+"),n={name:"CrmCell",components:{},mixins:[a("dAOq").a],props:{crmType:String,data:Object,section:Number,index:Number},data:function(){return{}},computed:{iconObj:function(){return{icon:this.crmType,color:{contract:"#FD5B4A",receivables:"#FFB940",invoice:"#1cbaf5"}[this.crmType]||"blue"}},relateData:function(){return"contract"==this.crmType?{type:"customer",typeName:"客户",id:this.data.customer_id,name:this.data.customer_name}:"receivables"==this.crmType?{type:"contract",typeName:"合同",id:this.data.contract_id,name:this.data.contract_name}:null},moreTypes:function(){var e=[];return this.data.permission&&this.data.permission.is_recheck&&e.push({type:"withdraw",name:"撤销",icon:"reset"}),e},canCheck:function(){return this.data.permission&&this.data.permission.is_check}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{handleClick:function(e){this.$emit("handle",e,this.data,this.index,this.section)},checkRelationDetail:function(){this.$emit("handle","relate-detail",this.relateData,this.index,this.section)},handleTypeDrop:function(e){this.$emit("handle",e,this.data,this.index,this.section)}}},l=(a("RQYR"),a("KHd+")),c=Object(l.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"section"},[a("div",{staticClass:"examine-cell"},[a("flexbox",{staticClass:"person"},[e.data.create_user_info?a("xr-avatar",{staticClass:"person__hd",attrs:{name:e.data.create_user_info.realname,id:e.data.create_user_info.id,size:40,src:e.data.create_user_info.img,disabled:!1}}):e._e(),e._v(" "),a("div",{staticClass:"person__bd"},[a("div",{staticClass:"person__bd-name"},[e._v(e._s(e.data.create_user_info.realname))]),e._v(" "),a("div",{staticClass:"person__bd-des"},[e._v(e._s("创建审批于 "+e.data.create_time))])]),e._v(" "),a("div",{staticClass:"rt-setting"},[a("span",{staticClass:"dep"},[a("span",[e._v(e._s(e.getTaskStatusName(e.data.check_status)))])]),e._v(" "),a("span",{staticClass:"bg-color",style:{"background-color":e.getTaskStatusColor(e.data.check_status)}})])],1),e._v(" "),a("div",{staticClass:"examine-cell__bd"},[e.data.content?a("p",{staticClass:"examine-cell__bd--content"},[e._v(e._s(e.data.content))]):e._e(),e._v(" "),a("flexbox",{staticClass:"examine-content"},[a("i",{class:["wk","examine-content__hd","wk-"+e.iconObj.icon],style:{backgroundColor:e.iconObj.color}}),e._v(" "),a("div",{staticClass:"examine-content__bd"},[a("div",[a("a",{on:{click:function(t){e.handleClick("detail")}}},[e._v(e._s(e.data.name))])]),e._v(" "),e.data.causeTitle?a("div",{staticClass:"examine-content__bd--des"},[e._v(e._s(e.data.causeTitle))]):e._e()])]),e._v(" "),a("div",{staticClass:"examine-stage"},[a("i",{class:e.getStatusIcon(e.data.check_status),style:{color:e.getTaskStatusColor(e.data.check_status)}}),a("span",[e._v(e._s(""+(e.data.examineName||"")+e.getTaskStatusName(e.data.check_status)))])]),e._v(" "),e.relateData&&e.relateData.id?a("div",{staticClass:"examine-relate"},[a("div",{staticClass:"examine-relate__hd"},[e._v("相关信息")]),e._v(" "),a("div",{staticClass:"examine-relate__bd"},[a("flexbox",{staticClass:"relate-cell",attrs:{align:"stretch"}},[a("div",{staticClass:"relate-cell__hd"},[a("i",{staticClass:"wk wk-contacts"}),e._v(" "),a("span",[e._v(e._s("相关"+e.relateData.typeName)+"：")])]),e._v(" "),a("div",{staticClass:"relate-cell__bd"},[a("div",{staticClass:"relate-cell__bd--item text-one-line"},[a("a",{on:{click:e.checkRelationDetail}},[e._v(e._s(e.relateData.name))])])])])],1)]):e._e()],1)],1),e._v(" "),a("div",{staticClass:"section__ft"},[e.canCheck?a("el-button",{staticClass:"xr-btn--red handle-button",attrs:{icon:"wk wk-close",type:"primary"},on:{click:function(t){e.handleClick("reject")}}},[e._v("拒绝")]):e._e(),e._v(" "),e.canCheck?a("el-button",{staticClass:"xr-btn--green handle-button",attrs:{icon:"wk wk-success",type:"primary"},nativeOn:{click:function(t){e.handleClick("pass")}}},[e._v("通过")]):e._e(),e._v(" "),e.moreTypes.length>0?a("el-dropdown",{staticStyle:{float:"right"},attrs:{trigger:"click"},on:{command:e.handleTypeDrop}},[a("el-button",{staticClass:"handle-button",attrs:{icon:"el-icon-more"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.moreTypes,function(t,s){return a("el-dropdown-item",{key:s,attrs:{icon:e._f("wkIconPre")(t.icon),command:t.type}},[e._v(e._s(t.name))])}))],1):e._e()],1)])},[],!1,null,"030b2518",null);c.options.__file="CrmCell.vue";var o=c.exports,r=a("yPq4"),u=a("QhmF"),d={name:"Index",components:{BaseTabsHead:i.a,CrmCell:o,CRMAllDetail:r.a,ExamineHandle:u.a},mixins:[],props:{},data:function(){return{crmType:"",tabsSelectValue:"0",tabs:[{label:"全部",name:"all"},{label:"待我审批的",name:"0"},{label:"我已审批的",name:"1"}],list:[],loading:!1,noMore:!1,scrollKey:Date.now(),page:1,detailIndex:0,rowID:"",rowData:{},detailCrmType:"",showCrmDetail:!1,showExamineHandle:!1,recordId:"",examineStatus:1}},computed:{scrollDisabled:function(){return this.loading||this.noMore}},watch:{},mounted:function(){this.crmType=this.$route.params.type},beforeRouteUpdate:function(e,t,a){this.crmType=e.params.type,this.tabsSelectValue="0",this.refreshList(),a()},beforeDestroy:function(){},methods:{refreshList:function(){this.page=1,this.list=[],this.noMore=!1,this.scrollKey=Date.now()},getList:function(){var e=this;this.loading=!0;var t={page:this.page,limit:15,status:"all"==this.tabsSelectValue?"all":this.tabsSelectValue};"contract"==this.crmType?t.type=1:"receivables"==this.crmType?t.type=2:"invoice"==this.crmType&&(t.type=3),Object(s.g)(t).then(function(a){e.loading=!1;var s="all"==e.tabsSelectValue?"all":e.tabsSelectValue;t.status==s?(e.noMore||(e.list=e.list.concat(a.data.page.list),e.page++),e.noMore=a.data.page.lastPage):e.refreshList()}).catch(function(){e.noMore=!0,e.loading=!1})},tabsChange:function(e){this.refreshList()},cellHandle:function(e,t,a){this.detailIndex=a,"detail"==e?(this.detailCrmType=this.crmType,this.rowID=t.catagory_id,this.showCrmDetail=!0):"relate-detail"==e?(this.showDview=!1,this.rowID=t.id,this.detailCrmType=t.type,this.showCrmDetail=!0):"reject"!=e&&"pass"!=e&&"withdraw"!=e||(this.rowID=t.catagory_id,this.examineStatus={pass:1,reject:2,withdraw:4}[e],this.rowData=t,this.showExamineHandle=!0)},examineHandleCallBack:function(e){this.refreshDataByHandle()},refreshDataByHandle:function(){this.refreshList()},detailHandleCallBack:function(e,t){this.detailIndex=t,this.refreshDataByHandle()}}},h=(a("zPPb"),Object(l.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("base-tabs-head",{attrs:{tabs:e.tabs,"select-value":e.tabsSelectValue},on:{"update:selectValue":function(t){e.tabsSelectValue=t},change:e.tabsChange}}),e._v(" "),a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.getList,expression:"getList"}],key:""+e.scrollKey+e.tabsSelectValue,staticClass:"cell-section",attrs:{"infinite-scroll-distance":"100","infinite-scroll-disabled":"scrollDisabled"}},[e._l(e.list,function(t,s){return a("crm-cell",{key:s,attrs:{"crm-type":e.crmType,data:t,index:s},on:{handle:e.cellHandle}})}),e._v(" "),e.loading?a("p",{staticClass:"scroll-bottom-tips"},[e._v("加载中...")]):e._e(),e._v(" "),e.noMore?a("p",{staticClass:"scroll-bottom-tips"},[e._v("没有更多了")]):e._e()],2),e._v(" "),a("c-r-m-all-detail",{attrs:{visible:e.showCrmDetail,"crm-type":e.detailCrmType,id:e.rowID,"no-listener-class":["relate-cell","examine-content"]},on:{"update:visible":function(t){e.showCrmDetail=t}}}),e._v(" "),a("examine-handle",{attrs:{show:e.showExamineHandle,id:e.rowID,"record-id":e.rowData.examineRecordId,detail:e.rowData,status:e.examineStatus,"examine-type":"crm_"+e.crmType},on:{close:function(t){e.showExamineHandle=!1},save:e.examineHandleCallBack}})],1)},[],!1,null,"4e8e01ae",null));h.options.__file="index.vue";t.default=h.exports},vW4c:function(e,t,a){},zPPb:function(e,t,a){"use strict";var s=a("a/y2");a.n(s).a}}]);